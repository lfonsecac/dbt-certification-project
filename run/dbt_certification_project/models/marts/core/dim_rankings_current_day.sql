-- back compat for old kwarg name
  
  begin;
    
        
            
            
        
    

    

    merge into BOARDGAME.dbt_prod.dim_rankings_current_day as DBT_INTERNAL_DEST
        using BOARDGAME.dbt_prod.dim_rankings_current_day__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.ranking_key = DBT_INTERNAL_DEST.ranking_key
            )

    
    when matched then update set
        "RANKING_KEY" = DBT_INTERNAL_SOURCE."RANKING_KEY","BOARDGAME_KEY" = DBT_INTERNAL_SOURCE."BOARDGAME_KEY","BOARDGAME_RANK" = DBT_INTERNAL_SOURCE."BOARDGAME_RANK","BOARDGAME_TOTAL_REVIEWS" = DBT_INTERNAL_SOURCE."BOARDGAME_TOTAL_REVIEWS","BOARDGAME_URL" = DBT_INTERNAL_SOURCE."BOARDGAME_URL","BOARDGAME_THUMBNAIL" = DBT_INTERNAL_SOURCE."BOARDGAME_THUMBNAIL","UPDATED_AT" = DBT_INTERNAL_SOURCE."UPDATED_AT","VALID_FROM" = DBT_INTERNAL_SOURCE."VALID_FROM","VALID_TO" = DBT_INTERNAL_SOURCE."VALID_TO","IS_CURRENT" = DBT_INTERNAL_SOURCE."IS_CURRENT"
    

    when not matched then insert
        ("RANKING_KEY", "BOARDGAME_KEY", "BOARDGAME_RANK", "BOARDGAME_TOTAL_REVIEWS", "BOARDGAME_URL", "BOARDGAME_THUMBNAIL", "UPDATED_AT", "VALID_FROM", "VALID_TO", "IS_CURRENT")
    values
        ("RANKING_KEY", "BOARDGAME_KEY", "BOARDGAME_RANK", "BOARDGAME_TOTAL_REVIEWS", "BOARDGAME_URL", "BOARDGAME_THUMBNAIL", "UPDATED_AT", "VALID_FROM", "VALID_TO", "IS_CURRENT")

;
    commit;